// Function to handle successful QR code scans
function onScanSuccess(qrCodeMessage) {
    // Handle the scanned QR code message
    console.log("QR Code scanned:", qrCodeMessage);
    // Redirect to the attendance URL or perform any desired action
    window.location.href = qrCodeMessage; // This will redirect to the scanned URL
}

// Function to handle scan errors
function onScanError(errorMessage) {
    // Optional: handle scan error
    console.error("Scan error:", errorMessage);
}

// Function to start scanning
function startScanning() {
    // Create an instance of Html5Qrcode
    const html5QrCode = new Html5Qrcode("reader");
    
    // Start scanning with specified configurations
    html5QrCode.start(
        { facingMode: "environment" }, // Use the back camera
        { fps: 10, qrbox: 250 } // Frame rate and QR box size
    ).then(() => {
        console.log("Scanning started successfully.");
    }).catch(err => {
        console.error("Error starting scanning:", err);
    });

    // Stop scanning after a certain time (optional)
    setTimeout(() => {
        stopScanning();
    }, 30000); // Stops scanning after 30 seconds
}

// Function to stop scanning
function stopScanning() {
    const html5QrCode = new Html5Qrcode("reader");
    
    // Stop scanning and redirect to another page or action
    html5QrCode.stop().then(ignore => {
        console.log("Scanning stopped.");
        // Redirect to main system or desired page
        window.location.href = './'; // Change this to your desired URL
    }).catch(err => {
        console.error("Error stopping scanning:", err);
    });
}

// Start scanning when the page loads
document.addEventListener("DOMContentLoaded", startScanning);
